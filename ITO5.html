<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ITO ë°œì£¼ì„œ PDF ì¶œë ¥</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.3.1/html-docx.js"></script>
<style>
:root{
  --bg:#0f172a;--panel:#1e293b;--ink:#e2e8f0;--muted:#94a3b8;
  --accent:#3b82f6;--border:#334155;--paper:#fff;--ink2:#1e293b;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:"Batang","ë°”íƒ•",serif;background:var(--bg);color:var(--ink);min-height:100vh}

header{background:var(--panel);border-bottom:1px solid var(--border);padding:20px;position:sticky;top:0;z-index:100}
.header-content{max-width:1400px;margin:0 auto;display:flex;gap:16px;align-items:center;flex-wrap:wrap}
.btn{padding:10px 18px;border-radius:8px;border:none;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s;font-family:sans-serif}
.btn-primary{background:var(--accent);color:#fff}
.btn-primary:hover{background:#2563eb}
.btn-success{background:#10b981;color:#fff}
.btn-success:hover{background:#059669}
.btn:disabled{opacity:.5;cursor:not-allowed}
.file-input{padding:8px 14px;border:1px solid var(--border);border-radius:8px;background:#0f172a;color:var(--ink);font-size:14px;font-family:sans-serif}
.select{padding:8px 14px;border:1px solid var(--border);border-radius:8px;background:#0f172a;color:var(--ink);font-size:14px;min-width:200px;font-family:sans-serif}
.po-dropdown{position:absolute;top:100%;left:0;max-height:200px;overflow-y:auto;border:1px solid var(--border);border-radius:8px;background:#0f172a;display:none;margin-top:4px;z-index:1000;width:100%;max-width:400px;box-shadow:0 4px 12px rgba(0,0,0,0.5)}
.po-dropdown-item{padding:10px 14px;cursor:pointer;border-bottom:1px solid var(--border);font-size:14px;color:var(--ink)}
.po-dropdown-item:hover{background:#1e293b}
.po-dropdown-item:last-child{border-bottom:none}
.po-dropdown.show{display:block}

main{max-width:1400px;margin:20px auto;padding:0 20px}
.controls{background:var(--panel);padding:20px;border-radius:12px;margin-bottom:20px;border:1px solid var(--border)}
.control-row{display:flex;gap:12px;align-items:center;margin-bottom:12px}
.control-row:last-child{margin-bottom:0}
.label{font-size:14px;color:var(--muted);min-width:100px;font-family:sans-serif}
.hint{font-size:12px;color:var(--muted);margin-top:8px;font-family:sans-serif}

.paper-container{background:var(--panel);padding:20px;border-radius:12px;border:1px solid var(--border)}
.paper{width:210mm;min-height:297mm;background:var(--paper);color:var(--ink2);margin:0 auto 20px;padding:15mm 20mm;position:relative;box-shadow:0 4px 20px rgba(0,0,0,.3)}

.doc-header{text-align:center;margin-bottom:8mm;border-bottom:2px solid #000;padding-bottom:8mm}
.doc-title{font-size:32px;font-weight:800;letter-spacing:4px;margin-bottom:4px}
.doc-subtitle{font-size:14px;color:#666;letter-spacing:2px}

.po-info{display:flex;justify-content:space-between;margin-bottom:8mm;font-size:13px}
.po-info-item{display:flex;gap:8px}
.po-info-label{font-weight:600}

.parties-section{display:grid;grid-template-columns:1fr 1fr;gap:15mm;margin-bottom:8mm;font-size:12px}
.party-box{border:1px solid #000;min-height:120px}
.party-title{background:#f0f0f0;padding:6px 10px;font-weight:700;text-align:left;border-bottom:1px solid #000}
.party-content{padding:8px 10px}
.party-row{display:grid;grid-template-columns:70px 1fr;margin-bottom:4px}
.party-row:last-child{margin-bottom:0}
.party-label{font-weight:600}

.greeting{text-align:center;margin:8mm 0;font-size:13px;line-height:1.8}

.items-table{width:100%;border-collapse:collapse;margin-bottom:6mm;font-size:12px}
.items-table th,.items-table td{border:1px solid #000;padding:6px 8px;text-align:center}
.items-table th{background:#f0f0f0;font-weight:700}
.items-table .desc{text-align:left}
.items-table .amount{text-align:right}

.contract-info{margin-bottom:6mm;font-size:12px;line-height:1.8}
.contract-info div{margin-bottom:3px}

.terms-section{margin-bottom:6mm;font-size:11px;line-height:1.7}
.terms-title{font-weight:700;margin-bottom:4px}
.terms-content{padding-left:8px}
.term-item{margin-bottom:6px}

.footer-notice{text-align:center;font-size:11px;margin-bottom:8mm;border-top:1px solid #ddd;border-bottom:1px solid #ddd;padding:8px 0}

.summary-box{width:250px;margin-left:auto;border:1px solid #000;font-size:12px}
.summary-row{display:flex;border-bottom:1px solid #000}
.summary-row:last-child{border-bottom:none}
.summary-row.total{background:#f0f0f0;font-weight:700}
.summary-label{width:100px;padding:6px 10px;border-right:1px solid #000;font-weight:600}
.summary-value{flex:1;padding:6px 10px;text-align:right}

.company-stamp{text-align:center;margin-top:10mm;font-size:13px;font-weight:700}

.page-number{position:absolute;bottom:10mm;right:20mm;font-size:11px;color:#666}

/* Page 2 styles */
.page2-title{font-size:18px;font-weight:700;text-align:center;margin-bottom:8mm;padding-bottom:4mm;border-bottom:2px solid #000}
.agreement-content{font-size:11px;line-height:1.8}
.agreement-section{margin-bottom:8mm}
.agreement-header{background:#f0f0f0;padding:8px;margin-bottom:6px;border:1px solid #000}
.agreement-article{margin-bottom:6mm}
.article-title{font-weight:700;margin-bottom:4px}
.article-content{padding-left:12px}
.article-item{margin-bottom:3px}
.signature-section{display:grid;grid-template-columns:1fr 1fr;gap:20mm;margin-top:15mm}
.signature-box{border:1px solid #000;padding:15px;text-align:left}
.signature-title{font-weight:700;margin-bottom:10px;font-size:14px}
.signature-info{font-size:12px;line-height:2}
.send-status{text-align:center;margin-top:10mm;color:#e74c3c;font-weight:700;font-size:13px}

@media print{
  body{background:#fff}
  header,.controls{display:none}
  .paper-container{background:none;padding:0;border:none}
  .paper{box-shadow:none;margin:0;page-break-after:always}
}
</style>
</head>
<body>

<header>
  <div class="header-content">
    <strong style="font-size:18px">ğŸ“„ ITO ë°œì£¼ì„œ ìƒì„±ê¸°</strong>
    <input type="file" id="fileInput" accept=".xlsx,.xls" class="file-input">
    <button id="fillBtn" class="btn btn-primary" disabled>ğŸ” ì¡°íšŒí•˜ê¸°</button>
    <button id="pdfBtn" class="btn btn-success" disabled>ğŸ’¾ PDF ë‹¤ìš´ë¡œë“œ</button>
    <button id="wordBtn" class="btn btn-success" disabled>ğŸ“„ Word ë‹¤ìš´ë¡œë“œ</button>
  </div>
</header>

<main>
  <div class="controls">
    <div class="control-row">
      <span class="label">ë°œì£¼ë²ˆí˜¸ ì„ íƒ:</span>
      <div style="position:relative;flex:1">
        <input type="text" id="poSearch" class="select" placeholder="ë°œì£¼ë²ˆí˜¸ ê²€ìƒ‰..." disabled style="width:100%;max-width:400px">
        <div id="poDropdown" class="po-dropdown"></div>
      </div>
      <select id="poSelect" class="select" disabled style="display:none">
        <option value="">íŒŒì¼ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
      </select>
    </div>
    <div class="hint">â€» ITO.xlsx íŒŒì¼ì„ ì„ íƒí•˜ë©´ '25ë…„' ì‹œíŠ¸ì˜ ë°œì£¼ë²ˆí˜¸ ëª©ë¡ì´ ìë™ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</div>
  </div>

  <div class="paper-container">
    <!-- PAGE 1 -->
    <div class="paper" id="printArea1">
      
      <div class="doc-header">
        <div class="doc-title">ë°œ ì£¼ ì„œ</div>
        <div class="doc-subtitle">Purchase Order</div>
      </div>

      <div class="po-info">
        <div class="po-info-item">
          <span class="po-info-label">ë°œì£¼ë²ˆí˜¸ :</span>
          <span id="poNumber">-</span>
        </div>
        <div class="po-info-item">
          <span class="po-info-label">ë°œì£¼ì¼ì :</span>
          <span id="poDate">-</span>
        </div>
        <div class="po-info-item" style="color:#e74c3c;font-weight:700">
          <span id="sendStatus">ë¯¸ë°œì†¡</span>
        </div>
      </div>

      <div class="parties-section">
        <div class="party-box">
          <div class="party-title">ê³µê¸‰ì²˜</div>
          <div class="party-content">
            <div class="party-row">
              <span class="party-label">ìƒã€€ã€€í˜¸ :</span>
              <span id="supplierName">ì½”ë°”ì•„ì´í‹°(ì£¼)</span>
            </div>
            <div class="party-row">
              <span class="party-label">ëŒ€ í‘œ ì :</span>
              <span id="supplierCEO">ìœ¤ì¸ë•</span>
            </div>
            <div class="party-row">
              <span class="party-label">ì£¼ã€€ã€€ì†Œ :</span>
              <span id="supplierAddr">ì„œìš¸ì‹œ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ 5ê°€ê¸¸ 28</span>
            </div>
            <div class="party-row">
              <span class="party-label">ë‹´ ë‹¹ ì :</span>
              <span id="supplierContact">ë°•ìš©ì§„ ë¶€ì¥</span>
            </div>
            <div class="party-row">
              <span class="party-label">ì „í™”ë²ˆí˜¸ :</span>
              <span id="supplierPhone">02-6244-9733</span>
            </div>
          </div>
        </div>

        <div class="party-box">
          <div class="party-title">ë°œì£¼ì²˜</div>
          <div class="party-content">
            <div class="party-row">
              <span class="party-label">ìƒã€€ã€€í˜¸ :</span>
              <span id="buyerName">í•œì†”í”¼ì—”ì—ìŠ¤ãˆœ</span>
            </div>
            <div class="party-row">
              <span class="party-label">ëŒ€ í‘œ ì :</span>
              <span id="buyerCEO">ê¹€í˜•ì¤€</span>
            </div>
            <div class="party-row">
              <span class="party-label">ì£¼ã€€ã€€ì†Œ :</span>
              <span id="buyerAddr">ì„œìš¸ì‹œ ê°•ì„œêµ¬ ì–‘ì²œë¡œ 570 NHì„œìš¸íƒ€ì›Œ 6ì¸µ</span>
            </div>
            <div class="party-row">
              <span class="party-label">ë‹´ ë‹¹ ì :</span>
              <span id="buyerContact">ìµœìŠ¹ì² </span>
            </div>
            <div class="party-row">
              <span class="party-label">ì´ ë©” ì¼ :</span>
              <span id="buyerEmail">seungcheol.choi@hansol.com</span>
            </div>
          </div>
        </div>
      </div>

      <div class="greeting">
        ê·€ì‚¬ì˜ ì¼ìµ ë²ˆì°½ì„ ê¸°ì›í•˜ë©°, ì•„ë˜ì™€ ê°™ì´ ë°œì£¼í•©ë‹ˆë‹¤.
      </div>

      <table class="items-table">
        <thead>
          <tr>
            <th style="width:40px">No</th>
            <th style="width:80px">PO No</th>
            <th>í’ˆëª… ë° ê·œê²©</th>
            <th style="width:60px">ìˆ˜ëŸ‰</th>
            <th style="width:50px">ë‹¨ìœ„</th>
            <th style="width:100px">ë‹¨ê°€</th>
            <th style="width:100px">ê¸ˆì•¡</th>
            <th style="width:80px">ë¹„ê³ </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td id="itemPoNo">-</td>
            <td class="desc" id="itemDesc">-</td>
            <td id="itemQty" class="amount">-</td>
            <td id="itemUnit">-</td>
            <td id="itemPrice" class="amount">-</td>
            <td id="itemAmount" class="amount">-</td>
            <td id="itemNote">-</td>
          </tr>
        </tbody>
      </table>

      <div class="contract-info">
        <div><strong>ê³„ì•½ê¸°ê°„ :</strong> <span id="contractPeriod">-</span></div>
        <div><strong>ìš©ì—­(ìˆ˜í–‰) ì¥ì†Œ :</strong> <span id="workLocation">êµ¬ë§¤ì ì§€ì •ì¥ì†Œ</span></div>
        <div><strong>ëŒ€ê¸‰ì§€ê¸‰ì¡°ê±´ :</strong> <span id="paymentTerms">ì¼ì‹œë‚© ì²­êµ¬_30ì¼ë‚´ í˜„ê¸ˆì§€ê¸‰</span></div>
        <div><strong>ì§€ì²´ìƒê¸ˆìœ¨ :</strong> <span id="penaltyRate">í•´ë‹¹ì‚¬í•­ ì—†ìŒ</span></div>
      </div>

      <div class="terms-section">
        <div class="terms-title">íŠ¹ê¸°ì‚¬í•­</div>
        <div class="terms-content">
          <div class="term-item">
            <strong>- ê²€ìˆ˜ ì‹œê¸° ë° ë°©ë²• :</strong> ê³µê¸‰ì²˜ëŠ” ë°œì£¼ì„œì— ëª…ì‹œëœ ëª©ì ë¬¼ì˜ ë‚©í’ˆ ë° ìˆ˜í–‰ ì™„ë£Œ ì‹œ ì‚¬ì „ í•©ì˜ëœ ê²€ìˆ˜ ë°©ë²•, ì¥ì†Œ, ì¼ìì— ë”°ë¼ ê²€ìˆ˜í™•ì¸ì„œë¥¼ ì‘ì„±í•˜ì—¬ ë°œì£¼ì²˜ì˜ ìˆ˜ë ¹ì ë˜ëŠ” ê³¼ì—… ì§€ì‹œìì—ê²Œ ê²€ìˆ˜ í™•ì¸ì„ ë°›ì•„ì•¼ í•œë‹¤.<br>
            ê²€ìˆ˜ìš”ì²­ì´ ìˆì€ ë‚ ë¡œë¶€í„° ì˜ì—…ì¼ ê¸°ì¤€ 10ì¼ ì´ë‚´ì— ë°œì£¼ì²˜ì˜ ê²€ì‚¬ê²°ê³¼ ë° ë¶ˆí•©ê²© ì‚¬ìœ ì— ëŒ€í•œ ì„œë©´ í†µì§€ê°€ ì—†ëŠ” ê²½ìš° ê²€ì‚¬ì— í•©ê²©í•œ ê²ƒìœ¼ë¡œ ë³¸ë‹¤.
          </div>
          <div class="term-item">
            <strong>- í•˜ë„ê¸‰ëŒ€ê¸ˆ ì¡°ì • :</strong> ìˆ˜ê¸‰ì‚¬ì—…ìëŠ” ê³„ì•½ê¸°ê°„ ì¤‘ ë¬¼ê°€ë³€ë™ì´ë‚˜ ëŒ€ê¸ˆì‚°ì •ì˜ ê¸°ì´ˆê°€ ëœ ì¡°ê±´ì˜ ì¼ë¶€ê°€ ë³€ê²½ë˜ëŠ” ë“± ì •ë‹¹í•œ ì‚¬ìœ ê°€ ìˆê±°ë‚˜, ì›ì‚¬ì—…ìì˜ ìš”êµ¬ì™€ ê´€ê³„ì—†ì´ ì‘ì—…ê¸°ê°„ ë˜ëŠ” ì‘ì—…ë¬¼ëŸ‰ì˜ ì¦ê°€ ë“±ìœ¼ë¡œ ìˆ˜ê¸‰ì‚¬ì—…ìì˜ ê³¼ì—…ì´ ë³€ê²½ë˜ê±°ë‚˜ ì¦ê°€í•˜ì˜€ë‹¤ê³  íŒë‹¨ë  ê²½ìš°, ì›ì‚¬ì—…ìì—ê²Œ í•˜ë„ê¸‰ëŒ€ê¸ˆì˜ ì¡°ì •ì„ ì„œë©´ìœ¼ë¡œ ìš”ì²­í•  ìˆ˜ ìˆë‹¤.
          </div>
        </div>
      </div>

      <div class="footer-notice">
        â€» ê·€ì‚¬ì˜ ê²¬ì ê³¼ ë‹¹ì‚¬ì˜ ë°œì£¼ì„œ ë‚´ìš© ì¼ì¹˜ ì‹œ ì¸ì¥ ë‚ ì¸ í›„ ì›ë³¸ ë˜ëŠ” ì‚¬ë³¸ì„ ë°œì£¼ì²˜ì— íšŒì‹  ë°”ëë‹ˆë‹¤.
      </div>

      <div class="summary-box">
        <div class="summary-row">
          <div class="summary-label">ê³µê¸‰ê°€ì•¡</div>
          <div class="summary-value" id="supplyAmount">0</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">ë¶€ê°€ì„¸ì•¡</div>
          <div class="summary-value" id="taxAmount">0</div>
        </div>
        <div class="summary-row total">
          <div class="summary-label">í•©ê³„ê¸ˆì•¡</div>
          <div class="summary-value" id="totalAmount">0</div>
        </div>
      </div>

      <div class="company-stamp">
        í•œì†”í”¼ì—”ì—ìŠ¤ ì£¼ì‹íšŒì‚¬
      </div>

      <div class="page-number">Page 1 of 2</div>
    </div>

    <!-- PAGE 2 -->
    <div class="paper" id="printArea2">
      <div class="page2-title">ì •ë³´ë³´í˜¸ í˜‘ì•½ì„œ</div>

      <div class="agreement-header">
        í•œì†”í”¼ì—”ì—ìŠ¤ãˆœì•„ì´í‹°ì„œë¹„ìŠ¤ë¶€ë¬¸ (ì´í•˜ "ìœ„íƒì"ì´ë¼ í•œë‹¤)ì™€(ê³¼) <span id="supplierName2">ì½”ë°”ì•„ì´í‹°(ì£¼)</span> (ì´í•˜ "ìˆ˜íƒì"ë¼ í•œë‹¤)ì€(ëŠ”) ë‹¤ìŒê³¼ ê°™ì´ ì •ë³´ë³´í˜¸ í˜‘ì•½ì„ ì²´ê²°í•œë‹¤.
      </div>

      <div class="agreement-content">
        <div style="margin-bottom:8mm">
          <strong>â–£ ê³ ê°ì‚¬ ë° ìˆ˜í–‰ë‚´ì—­ :</strong> <span id="projectDesc">ì œì§€(í™˜ê²½ì‚¬ì—…ë³¸ë¶€) AI Report ìœ ì§€ë³´ìˆ˜</span>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ1ì¡° (ê³„ì•½ì˜ ëª©ì )</div>
          <div class="article-content">
            ë³¸ í˜‘ì•½ì€ ìœ„íƒìì™€ ìˆ˜íƒìê°€ ì—…ë¬´ ìˆ˜í–‰ ì¤‘ì— ì–»ê²Œ ë˜ëŠ” ìƒí˜¸ ìì‹ ì˜ ë¹„ë°€ì •ë³´ ë° ê³ ê°ì‚¬ì˜ ë¹„ë°€ì •ë³´ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•¨ì„ ê·¸ ëª©ì ìœ¼ë¡œ í•œë‹¤.
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ2ì¡° (ì •ë³´ë³´í˜¸ì˜ ëŒ€ìƒ)</div>
          <div class="article-content">
            ë³¸ í˜‘ì•½ìƒì˜ ì •ë³´ë€ ìœ„íƒìÂ·ìˆ˜íƒìê°„ì˜ ì—…ë¬´ì§„í–‰ ê³¼ì •ì—ì„œ ì¼ë°© ë‹¹ì‚¬ì ë° ê³ ê°ì‚¬ê°€ ìƒëŒ€ë°©ì—ê²Œ ì œê³µí•˜ê±°ë‚˜ ì·¨ë“í•˜ëŠ” ì¼ì²´ì˜ ì˜ì—… í˜¹ì€ ê¸°ìˆ ìƒì˜ ì •ë³´ ë° ê°œì¸ì •ë³´(ì´í•˜ "ë¹„ë°€ì •ë³´"ë¼ í•œë‹¤)ë¥¼ ë§í•œë‹¤. ì„œë©´, êµ¬ë‘ í˜¹ì€ ê¸°íƒ€ ë°©ë²•ìœ¼ë¡œ ì œê³µë˜ëŠ” ëª¨ë“  ë…¸í•˜ìš°, ê³µì •, ë„ë©´, ì„¤ê³„, ì‹¤í—˜ê²°ê³¼, ìƒ˜í”Œ, ìŠ¤í™, ë°ì´í„°, ê³µì‹, ë°©ë²•, í”„ë¡œê·¸ë¨, ë³´ê³ ì„œ, ê³„íšì„œ, ê°€ê²©í‘œ, ê±°ë˜ëª…ì„¸ì„œ, ì„ ì „ìƒì˜ ì•„ì´ë””ì–´, ì‚¬ì—…ì •ë³´, ê³ ê°ì •ë³´, ì„ì§ì› ì •ë³´, ê°œì¸ì •ë³´ ë“±ì„ ëª¨ë‘ í¬í•¨í•œë‹¤.
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ3ì¡° (ì •ë³´ì˜ ì‚¬ìš© ìš©ë„ ì œí•œ)</div>
          <div class="article-content">
            ë³¸ í˜‘ì•½ì˜ ë‹¹ì‚¬ìëŠ” ìƒëŒ€ë°© ë° ê³ ê°ì‚¬ë¡œë¶€í„° ì œê³µë°›ì€ ë¹„ë°€ì •ë³´ë¥¼ ì—…ë¬´ëª©ì  ì™¸ì— ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë©°, ê³„ì•½ì˜ ìˆ˜í–‰ì„ ìœ„í•˜ì—¬ ìƒëŒ€ë°© ë° ê³ ê°ì‚¬ì— ê´€ë ¨ëœ ë¹„ë°€ì •ë³´ë¥¼ ì œ3ìì—ê²Œ ì œê³µí•  ê²½ìš°, ë‹¹í•´ ì œ3ìì™€ ë³„ë„ì˜ ì •ë³´ë³´í˜¸í˜‘ì•½ì„ ì²´ê²°í•˜ì—¬ì•¼ í•˜ë©° ì‚¬ì „ì— ìƒëŒ€ë°© ë° ê³ ê°ì‚¬ì˜ í—ˆê°€ë¥¼ ë“í•´ì•¼ í•œë‹¤.
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ4ì¡° (ì ìš©ê¸°ê°„)</div>
          <div class="article-content">
            ë³¸ í˜‘ì•½ì˜ ì •ë³´ë³´í˜¸ì˜ë¬´ëŠ” ê³„ì•½ê¸°ê°„ ë° ê³„ì•½ì´ ì¢…ë£Œëœ ì´í›„ 3ë…„ê°„ ìœ íš¨í•˜ë‹¤. ë‹¨, ê·¸ ì„±ì§ˆìƒ ê³„ì†í•˜ì—¬ íš¨ë ¥ì„ ìœ ì§€í•˜ì—¬ì•¼ í•  ì •ë³´ëŠ” ìœ íš¨ê¸°ê°„ì´ ë§Œë£Œëœ ì´í›„ì—ë„ ìœ íš¨í•˜ë‹¤.
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ5ì¡° (ê´€ë¦¬Â·ê°ë… ì‚¬í•­)</div>
          <div class="article-content">
            ìˆ˜íƒìëŠ” ìœ„íƒì ë° ê³ ê°ì‚¬ë¡œë¶€í„° ì œê³µë°›ì€ ì •ë³´ë¥¼ ìì‚¬ ì¡°ì§ ë‚´ ëª©ì ìƒ ë¶€í•©í•˜ëŠ” ì§ì›ë“¤ì— í•œí•˜ì—¬ ì´ìš©í•˜ë„ë¡ ì¡°ì¹˜í•˜ì—¬ì•¼ í•˜ë©° ì§ì› ê°ìì—ê²Œ ë¹„ë°€ìœ ì§€ì˜ë¬´ë¥¼ ì£¼ì§€ì‹œì¼œì•¼ í•œë‹¤. ë˜í•œ ìœ„íƒìê°€ ìš”êµ¬í•˜ëŠ” ê²½ìš° ìˆ˜íƒìëŠ” ìì‚¬ì˜ ê´€ê³„ì§ì›ë“¤ì— ëŒ€í•˜ì—¬ ë‹¹í•´ ì§ì›ì´ ë³¸ í˜‘ì•½ìƒì˜ ì •ë³´ë³´í˜¸ì˜ë¬´ë¥¼ ì´í–‰í•˜ê² ë‹¤ëŠ” ë‚´ìš©ì˜ ê°ì„œë¥¼ ì§•êµ¬í•˜ëŠ” ë“± ìœ„íƒìê°€ ë§Œì¡±í•  ìˆ˜ ìˆëŠ” ì ì ˆí•œ ì¡°ì¹˜ë¥¼ ì·¨í•˜ì—¬ì•¼ í•œë‹¤.
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ6ì¡° (ê¸°ìˆ ì Â·ê´€ë¦¬ì  ë³´í˜¸ì¡°ì¹˜)</div>
          <div class="article-content">
            ìˆ˜íƒìëŠ” ìœ„íƒì ë° ê³ ê°ì‚¬ë¡œë¶€í„° ì œê³µë°›ì€ ë¹„ë°€ì •ë³´ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•˜ì—¬ ì•„ë˜ ê°í˜¸ì— í•´ë‹¹í•˜ëŠ” ê¸°ìˆ ì , ê´€ë¦¬ì , ë¬¼ë¦¬ì  ë³´í˜¸ì¡°ì¹˜ë¥¼ ìˆ˜í–‰í•˜ì—¬ì•¼ í•œë‹¤.<br>
            <div style="padding-left:12px;margin-top:4px">
              ê°€. ë¹„ë°€ì •ë³´ì˜ ì•ˆì „í•œ ì·¨ê¸‰ì„ ìœ„í•œ ë‚´ë¶€ê´€ë¦¬ê³„íšì˜ ìˆ˜ë¦½Â·ì‹œí–‰ì˜ ë³´í˜¸ì¡°ì¹˜<br>
              ë‚˜. ë¹„ë°€ì •ë³´ì— ë¶ˆë²•ì ì¸ ì ‘ê·¼ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•œ ì ‘ê·¼í†µì œê·œì¹™, ì¹¨ì…ì°¨ë‹¨ì‹œìŠ¤í…œì˜ ì„¤ì¹˜Â·ìš´ì˜ ë“±ì˜ ë³´í˜¸ì¡°ì¹˜<br>
              ë‹¤. ë¹„ë°€ì •ë³´ì— ëŒ€í•œ ì ‘ì†ê¸°ë¡ì˜ ìœ„ì¡°Â·ë³€ì¡° ë°©ì§€ë¥¼ ìœ„í•œ ë³´í˜¸ì¡°ì¹˜<br>
              ë¼. ë¹„ë°€ì •ë³´ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥Â·ì „ì†¡ë  ìˆ˜ ìˆë„ë¡ ë³´í˜¸ì¡°ì¹˜<br>
              ë§ˆ. ì•…ì„±í”„ë¡œê·¸ë¨ì˜ ì¹¨íˆ¬ì—¬ë¶€ë¥¼ ì ê²€Â·ì¹˜ë£Œí•  ìˆ˜ ìˆëŠ” ë°±ì‹ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì„¤ì¹˜Â·ìš´ì˜<br>
              ë°”. ì£¼ìš” ê°œì¸ì •ë³´ ë° íŒ¨ìŠ¤ì›Œë“œ ì•”í˜¸í™” ì¡°ì¹˜<br>
              ì‚¬. ì „ì‚°ì‹¤ì— ëŒ€í•œ ì¶œì…í†µì œ ì¡°ì¹˜<br>
              ì•„. ë¹„ë°€ì •ë³´ê°€ ë‹´ê¸´ ë¬¸ì„œ, ì €ì¥ë§¤ì²´ì— ëŒ€í•œ ì‹œê±´ì¥ì¹˜ ì ìš© ë“± ë³´í˜¸ì¡°ì¹˜<br>
              ì. ê°œì¸ì •ë³´ë¥¼ ì·¨ê¸‰í•˜ëŠ” ê²½ìš° [ê°œì¸ì •ë³´ë³´í˜¸ë²•] ì œ24ì¡° ì œ3í•­ ë° ì œ29ì¡°, ë™ë²• ì‹œí–‰ë ¹ ì œ21ì¡° ë° ì œ30ì¡°, [ê°œì¸ì •ë³´ì˜ ì•ˆì „ì„± í™•ë³´ì¡°ì¹˜ ê¸°ì¤€]ì— ë”°ë¥¸ ê°œì¸ì •ë³´ì˜ ì•ˆì „ì„± í™•ë³´ì— í•„ìš”í•œ ê´€ë¦¬ì , ê¸°ìˆ ì  ì¡°ì¹˜
            </div>
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ7ì¡° (ë¹„ë°€ìœ ì§€ì˜ë¬´ ì œì™¸ì‚¬ìœ )</div>
          <div class="article-content">
            ìˆ˜íƒìëŠ” ê³„ì•½ë‚´ìš©ì— ê´€í•œ ë¹„ë°€ì€ ë¬¼ë¡  ë³¸ í˜‘ì•½ì— ëŒ€í•´ì„œë„ ìœ„íƒì ë° ê³ ê°ì‚¬ì˜ ë™ì˜ ì—†ì´ ëˆ„ì„¤í•˜ì§€ ëª»í•œë‹¤. ë‹¤ë§Œ, ë‹¤ìŒì— í•´ë‹¹í•˜ëŠ” ì •ë³´ì„ì´ ê°ê´€ì ì¸ ì¦ê±°ë¥¼ í†µí•˜ì—¬ ì…ì¦ë˜ëŠ” ê²½ìš°ëŠ” ë¹„ë°€ìœ ì§€ì˜ë¬´ê°€ ì—†ë‹¤.<br>
            <div style="padding-left:12px;margin-top:4px">
              ê°€. ìœ„íƒì ë° ê³ ê°ì‚¬ì˜ ë¹„ë°€ì •ë³´ ì œê³µ ì´ì „ë¶€í„° ìˆ˜íƒìê°€ ë³´ìœ í•˜ê³  ìˆë˜ ì •ë³´.<br>
              ë‚˜. ìˆ˜íƒìì˜ ê³ ì˜ ë˜ëŠ” ê³¼ì‹¤ì— ì˜í•˜ì§€ ì•Šê³  ê³µì§€ì˜ ì‚¬ì‹¤ë¡œ ëœ ì •ë³´.<br>
              ë‹¤. ìˆ˜íƒìê°€ ì ë²•í•˜ê²Œ ì œ3ìë¡œë¶€í„° ì œê³µë°›ì€ ì •ë³´.<br>
              ë¼. ìˆ˜íƒìê°€ ë¹„ë°€ì •ë³´ì™€ ê´€ê³„ì—†ì´ ë…ìì ìœ¼ë¡œ ê°œë°œí•œ ì •ë³´.<br>
              ë§ˆ. ìœ„íƒì ë° ê³ ê°ì‚¬ê°€ ê³µê°œë¥¼ í—ˆë½í•œ ì •ë³´.<br>
              ë°”. ê´€ë ¨ë²•ê·œë‚˜ ì •ë¶€ë‹¹êµ­ì— ì˜í•˜ì—¬ ê³µê°œê°€ ìš”êµ¬ëœ ì •ë³´. ì´ ê²½ìš° ì‚¬ì „ì— ë°˜ë“œì‹œ ìœ„íƒìì—ê²Œ ê·¸ ì‚¬ì‹¤ì„ ì„œë©´ìœ¼ë¡œ í†µì§€í•˜ê³ , ìœ„íƒìë¡œ í•˜ì—¬ê¸ˆ ì ì ˆí•œ ë³´í˜¸ ë° ëŒ€ì‘ì¡°ì¹˜ë¥¼ í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ì•¼ í•œë‹¤.
            </div>
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ8ì¡° (ì¹¨í•´ì‚¬ê³  ë°œìƒì‹œ ì±…ì„ ë° ì†í•´ë°°ìƒ)</div>
          <div class="article-content">
            ë‹¹ì‚¬ì ì¼ë°©ì´ ë³¸ í˜‘ì•½ì„ ìœ„ë°˜í•˜ëŠ” ê²½ìš° ê·€ì±…ì‚¬ìœ ê°€ ìˆëŠ” ë‹¹ì‚¬ìëŠ” ì´ë¡œ ì¸í•´ ìƒëŒ€ë°©ì—ê²Œ ë°œìƒí•˜ëŠ” ì†í•´ì— ëŒ€í•´ì„œ ì „ì•¡ ë°°ìƒí•œë‹¤.
          </div>
        </div>

        <div class="agreement-article">
          <div class="article-title">ì œ9ì¡° (ë¹„ë°€ì •ë³´ ë°˜í™˜ ë˜ëŠ” íŒŒê¸°)</div>
          <div class="article-content">
            ë³¸ ì—…ë¬´ì˜ ì´í–‰ì´ ì™„ë£Œë˜ê±°ë‚˜ ë³¸ ì—…ë¬´ì— ê´€í•œ ê³„ì•½ì´ í•´ì œ ë˜ëŠ” í•´ì§€ëœ ê²½ìš° ë˜ëŠ” ìœ„íƒìë‚˜ ìˆ˜íƒì ë˜ëŠ” ê³ ê°ì‚¬ê°€ ìƒëŒ€ë°©ì—ê²Œ ì œê³µí•œ ìì‹ ì˜ ë¹„ë°€ì •ë³´ì˜ ë°˜í™˜ì„ ìš”êµ¬í•  ê²½ìš°, ìƒëŒ€ë°©ì€ ë¹„ë°€ì •ë³´ë¥¼ ìƒëŒ€ë°©ì—ê²Œ ë°˜í™˜í•˜ê±°ë‚˜ íŒŒê¸°í•˜ì—¬ì•¼ í•œë‹¤. ë‹¨, íŒŒê¸°í•œ ê²½ìš°ì—ëŠ” ê·¸ ì¦ëª…ì„ ì„œë©´ìœ¼ë¡œ ì œì¶œí•˜ì—¬ì•¼ í•œë‹¤.<br>
            <div style="padding-left:12px;margin-top:4px">
              <strong>ê°€. íŒŒê¸°ë°©ë²•</strong><br>
              1) ì „ìì  íŒŒì¼í˜•íƒœë¡œ ì €ì¥ëœ ê°œì¸ì •ë³´ëŠ” ê¸°ë¡ì„ ì¬ìƒí•  ìˆ˜ ì—†ëŠ” ê¸°ìˆ ì  ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ ì‚­ì œí•˜ê±°ë‚˜ ë¬¼ë¦¬ì  íŒŒê¸°<br>
              2) ì¢…ì´ì— ì¶œë ¥ëœ ê°œì¸ì •ë³´ëŠ” ë¶„ì‡„ê¸°ë¡œ ë¶„ì‡„í•˜ê±°ë‚˜ ì†Œê°ì— ì¤€í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì™„ì „ íŒŒê¸°
            </div>
          </div>
        </div>
      </div>

      <div class="send-status">ë¯¸ë°œì†¡</div>

      <div class="signature-section">
        <div class="signature-box">
          <div class="signature-title">ìœ„íƒì</div>
          <div class="signature-info">
            <div id="buyerNameSig">í•œì†”í”¼ì—”ì—ìŠ¤ãˆœ</div>
            <div id="buyerAddrSig">ì„œìš¸ì‹œ ê°•ì„œêµ¬ ì–‘ì²œë¡œ 570 NHì„œìš¸íƒ€ì›Œ 6ì¸µ</div>
            <div id="buyerCEOSig">ê¹€í˜•ì¤€</div>
          </div>
        </div>
        <div class="signature-box">
          <div class="signature-title">ìˆ˜íƒì</div>
          <div class="signature-info">
            <div id="supplierNameSig">ì½”ë°”ì•„ì´í‹°(ì£¼)</div>
            <div id="supplierAddrSig">ì„œìš¸ì‹œ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ5ê°€ê¸¸ 28</div>
            <div id="supplierCEOSig">ìœ¤ì¸ë•</div>
          </div>
        </div>
      </div>

      <div class="page-number">Page 2 of 2</div>
    </div>
  </div>
</main>

<script>
let workbook = null;
let sheetData = null;
let allPONumbers = [];

const fileInput = document.getElementById('fileInput');
const poSearch = document.getElementById('poSearch');
const poSelect = document.getElementById('poSelect');
const poDropdown = document.getElementById('poDropdown');
const fillBtn = document.getElementById('fillBtn');
const pdfBtn = document.getElementById('pdfBtn');
const wordBtn = document.getElementById('wordBtn');

// ê¸°ë³¸ íŒŒì¼ ë¡œë“œ
window.addEventListener('load', loadDefaultFile);

fileInput.addEventListener('change', handleFile);
poSearch.addEventListener('input', filterPONumbers);
poSearch.addEventListener('focus', () => {
  if (allPONumbers.length > 0) poDropdown.classList.add('show');
});
document.addEventListener('click', (e) => {
  if (!poSearch.contains(e.target) && !poDropdown.contains(e.target)) {
    poDropdown.classList.remove('show');
  }
});
fillBtn.addEventListener('click', fillData);
pdfBtn.addEventListener('click', generatePDF);
wordBtn.addEventListener('click', generateWord);

async function loadDefaultFile() {
  try {
    const response = await fetch('https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/ITO.xlsx');
    const arrayBuffer = await response.arrayBuffer();
    const data = new Uint8Array(arrayBuffer);
    workbook = XLSX.read(data, {type: 'array'});
    processWorkbook();
  } catch (err) {
    console.log('ê¸°ë³¸ íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨, ìˆ˜ë™ ì—…ë¡œë“œë¥¼ ì´ìš©í•˜ì„¸ìš”:', err);
  }
}

function handleFile(e) {
  const file = e.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      workbook = XLSX.read(e.target.result, {type: 'binary'});
      processWorkbook();
    } catch (err) {
      alert('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: ' + err.message);
    }
  };
  reader.readAsBinaryString(file);
}

function processWorkbook() {
  let targetSheet = workbook.Sheets['25ë…„'] || workbook.Sheets[workbook.SheetNames[0]];
  sheetData = XLSX.utils.sheet_to_json(targetSheet, {header: 1, defval: ''});
  
  if (sheetData.length === 0) {
    alert('ì‹œíŠ¸ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }
  
  const headers = sheetData[0];
  const poColIdx = headers.findIndex(h => h === 'ë°œì£¼ë²ˆí˜¸');
  
  if (poColIdx === -1) {
    alert('"ë°œì£¼ë²ˆí˜¸" ì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }
  
  allPONumbers = [];
  for (let i = 1; i < sheetData.length; i++) {
    const poNum = sheetData[i][poColIdx];
    if (poNum) allPONumbers.push(poNum);
  }
  
  poSearch.disabled = false;
  fillBtn.disabled = false;
  pdfBtn.disabled = false;
  wordBtn.disabled = false;
  poSearch.placeholder = 'ë°œì£¼ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...';
  
  displayPONumbers(allPONumbers);
}

function filterPONumbers() {
  const searchTerm = poSearch.value.toLowerCase();
  const filtered = allPONumbers.filter(po => 
    String(po).toLowerCase().includes(searchTerm)
  );
  displayPONumbers(filtered);
  poDropdown.classList.add('show');
}

function displayPONumbers(numbers) {
  poDropdown.innerHTML = '';
  if (numbers.length === 0) {
    poDropdown.innerHTML = '<div class="po-dropdown-item">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
    return;
  }
  
  numbers.forEach(po => {
    const item = document.createElement('div');
    item.className = 'po-dropdown-item';
    item.textContent = po;
    item.addEventListener('click', () => {
      poSearch.value = po;
      poDropdown.classList.remove('show');
    });
    poDropdown.appendChild(item);
  });
}

function fillData() {
  const selectedPO = poSearch.value;
  if (!selectedPO || !sheetData) {
    alert('ë°œì£¼ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš”.');
    return;
  }
  
  const headers = sheetData[0];
  const getColIdx = (name) => headers.findIndex(h => h === name);
  
  const poColIdx = getColIdx('ë°œì£¼ë²ˆí˜¸');
  const rowIdx = sheetData.findIndex((row, idx) => idx > 0 && row[poColIdx] === selectedPO);
  
  if (rowIdx === -1) {
    alert('í•´ë‹¹ ë°œì£¼ë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }
  
  const row = sheetData[rowIdx];
  const getValue = (colName, defaultVal = '-') => {
    const idx = getColIdx(colName);
    return idx !== -1 && row[idx] ? row[idx] : defaultVal;
  };
  
  // ë°œì£¼ ê¸°ë³¸ ì •ë³´
  document.getElementById('poNumber').textContent = selectedPO;
  document.getElementById('poDate').textContent = formatDate(getValue('ë°œì£¼ì¼'));
  
  // í’ˆëª© ì •ë³´
  document.getElementById('itemPoNo').textContent = selectedPO;
  document.getElementById('itemDesc').textContent = getValue('ë‚´ìš©', 'ì œì§€(í™˜ê²½ì‚¬ì—…ë³¸ë¶€) AI Report ìœ ì§€ë³´ìˆ˜');
  
  const qty = parseFloat(getValue('ìˆ˜ëŸ‰', 12)) || 12;
  const unit = getValue('ë‹¨ìœ„', 'ê°œì›”');
  const price = parseFloat(getValue('ë‹¨ê°€', 10920000)) || 10920000;
  const amount = parseFloat(getValue('ë°œì£¼ê¸ˆì•¡', qty * price)) || (qty * price);
  
  document.getElementById('itemQty').textContent = formatNumber(qty);
  document.getElementById('itemUnit').textContent = unit;
  document.getElementById('itemPrice').textContent = formatNumber(price);
  document.getElementById('itemAmount').textContent = formatNumber(amount);
  document.getElementById('itemNote').textContent = getValue('ë¹„ê³ ', '');
  
  // ê¸ˆì•¡ ê³„ì‚°
  const supplyAmt = Math.round(amount / 12);
  const taxAmt = Math.round(supplyAmt * 0.1);
  const totalAmt = supplyAmt + taxAmt;
  
  document.getElementById('supplyAmount').textContent = formatNumber(supplyAmt);
  document.getElementById('taxAmount').textContent = formatNumber(taxAmt);
  document.getElementById('totalAmount').textContent = formatNumber(totalAmt);
  
  // ê³„ì•½ ê¸°ê°„
  const fromDate = getValue('FROM');
  const toDate = getValue('TO');
  if (fromDate && toDate && fromDate !== '-' && toDate !== '-') {
    document.getElementById('contractPeriod').textContent = 
      formatDate(fromDate) + ' ~ ' + formatDate(toDate);
  }
  
  // ê³µê¸‰ì²˜ ì •ë³´
  const supplierName = getValue('ê³µê¸‰ì²˜', 'ì½”ë°”ì•„ì´í‹°(ì£¼)');
  document.getElementById('supplierName').textContent = supplierName;
  document.getElementById('supplierName2').textContent = supplierName;
  document.getElementById('supplierNameSig').textContent = supplierName;
  
  // í”„ë¡œì íŠ¸ ì„¤ëª…
  document.getElementById('projectDesc').textContent = getValue('ë‚´ìš©', 'ì œì§€(í™˜ê²½ì‚¬ì—…ë³¸ë¶€) AI Report ìœ ì§€ë³´ìˆ˜');
  
  document.getElementById('workLocation').textContent = getValue('ìš©ì—­ì¥ì†Œ', 'êµ¬ë§¤ì ì§€ì •ì¥ì†Œ');
  document.getElementById('paymentTerms').textContent = getValue('ì§€ê¸‰ì¡°ê±´', 'ì¼ì‹œë‚© ì²­êµ¬_30ì¼ë‚´ í˜„ê¸ˆì§€ê¸‰');
}

function parseExcelDate(val) {
  if (typeof val === 'number') {
    return new Date((val - 25569) * 86400 * 1000);
  }
  if (typeof val === 'string' && val.includes('-')) {
    return new Date(val);
  }
  return null;
}

function formatDate(val) {
  if (!val || val === '-') return '-';
  const d = parseExcelDate(val);
  if (!d) return val;
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, '0');
  const day = String(d.getDate()).padStart(2, '0');
  return `${y}-${m}-${day}`;
}

function formatNumber(num) {
  if (isNaN(num)) return '-';
  return new Intl.NumberFormat('ko-KR').format(num);
}

function generatePDF() {
  const page1 = document.getElementById('printArea1');
  const page2 = document.getElementById('printArea2');
  
  const opt = {
    margin: 0,
    filename: `ë°œì£¼ì„œ_${document.getElementById('poNumber').textContent || 'ITO'}.pdf`,
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2, useCORS: true },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };
  
  html2pdf().set(opt).from(page1).toPdf().get('pdf').then(function(pdf) {
    pdf.addPage();
    return html2pdf().set(opt).from(page2).toPdf().get('pdf');
  }).then(function(pdf) {
    pdf.save(opt.filename);
  });
}

function generateWord() {
  const page1 = document.getElementById('printArea1').outerHTML;
  const page2 = document.getElementById('printArea2').outerHTML;
  
  const htmlContent = `
    <!DOCTYPE html>
    <html><head><meta charset="utf-8"></head><body>
    ${page1}
    <div style="page-break-before: always;"></div>
    ${page2}
    </body></html>
  `;
  
  const converted = htmlDocx.asBlob(htmlContent);
  const link = document.createElement('a');
  link.href = URL.createObjectURL(converted);
  link.download = `ë°œì£¼ì„œ_${document.getElementById('poNumber').textContent || 'ITO'}.docx`;
  link.click();
}
</script>